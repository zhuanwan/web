---
sidebar_position: 4
---

# 代码组合

:::tip 定义
compose 函数的作用就是组合函数的，将函数串联起来执行，将多个函数组合起来，一个函数的输出结果是另一个函数的输入参数，一旦第一个函数开始执行，就会像多米诺骨牌一样推导执行了。
:::

## 示例
``` js
var compose = function(f,g) {
  return function(x) {
    return f(g(x));
  };
};

var toUpperCase = (x) => x.toUpperCase(); // 大写
var exclaim = (x) =>  x + '!';
var shout = compose(exclaim, toUpperCase);

shout("send in the clowns");
// "SEND IN THE CLOWNS!"

```
f 和 g 都是函数，x 是在它们之间通过“管道”传输的值。

从右到左执行，上面示例 先大写，再加感叹号


可以自由组合

```js
  var head = (x) => x[0]; // 取数组第一个数
  var reverse = (arr) => arr.reduce((acc, x) => [x].concat(acc), []); // 反转数组
  var toUpperCase = (x) => x.toUpperCase(); // 大写


  let a = compose(toUpperCase, compose(head, reverse));
  // 或者
  let b = compose(compose(toUpperCase, head), reverse);

  console.log(a(["hello", "world"])) // WORLD
  console.log(b(["hello", "world"])) // WORLD
```

参数再加个函数

```js
function compose(f,g,m){
    return function(x){
        return f(g(m(x)));
    }
}
```

参数不固定

```js
function compose(...fns) {
  return function(x) {
    return fns.reduceRight((arg, fn) => {
      return fn(arg)
    }, x)
  }
}
```
## pointfree

pointfree 函数无须提及将要操作的数据是什么样的。一等公民的函数、柯里化（curry）以及组合协作起来非常有助于实现这种模式。

```js
// 非 pointfree，因为提到了数据：word
var snakeCase = function (word) {
  return word.toUpperCase() + '!';
};

// pointfree
var snakeCase = compose(exclaim, toUpperCase);
```

## 参考
https://juejin.cn/post/6844903910834962446

https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/ch5.html




