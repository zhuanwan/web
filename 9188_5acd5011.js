"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[9188],{79188:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Component)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(96540);\n/* harmony import */ var fabric__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(3676);\n/* harmony import */ var fabric__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fabric__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _pages_fabric_components_FabricText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(18945);\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(74848);\n\n\n\n\nfunction Component() {\n  var canvasRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n  var fabricCanvas = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n  var draw = function draw(canvas) {\n    var fullText = '鼠标移上去看看，我是很长很长的文本，我省略了很多字';\n    var text = new fabric__WEBPACK_IMPORTED_MODULE_1__.fabric.Text(fullText.substring(0, 6) + \"...\", {\n      left: 50,\n      top: 50,\n      fontSize: 14,\n      fill: '#f00',\n      fullText: fullText,\n      shouldTitleSuspend: 1\n    });\n    canvas.add(text);\n  };\n  var init = function init(canvas) {\n    if (!canvas) {\n      return;\n    }\n    // 重置上一次的canvas\n    canvas.off('mouse:down');\n    canvas.off('mouse:wheel');\n    canvas.off('mouse:move');\n    canvas.off('mouse:up');\n    canvas.clear();\n    canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\n    draw(canvas);\n    var nameTip = new _pages_fabric_components_FabricText__WEBPACK_IMPORTED_MODULE_2__/* .FabricText */ .X('', {\n      fill: '#333',\n      fontSize: 14,\n      backgroundColor: '#fff',\n      padding: 2,\n      showTextBoxBorder: true,\n      textboxBorderColor: '#333',\n      left: -9999,\n      top: -9999\n    });\n    canvas.add(nameTip);\n    canvas.on('mouse:over', function (opt) {\n      var target = opt.target,\n        e = opt.e;\n      if (target && target.shouldTitleSuspend === 1) {\n        var p = canvas.getPointer(e);\n        nameTip.set({\n          left: p.x,\n          top: p.y + 20,\n          text: target.fullText\n        });\n        nameTip.bringToFront();\n        canvas.renderAll();\n      }\n    });\n    canvas.on('mouse:out', function () {\n      nameTip.set({\n        left: -9999,\n        top: -9999\n      });\n      canvas.renderAll();\n    });\n    canvas.on('mouse:down', function (opt) {\n      var evt = opt.e;\n      canvas.isDragging = true; // isDragging 是自定义的\n      canvas.lastPosX = evt.clientX; // lastPosX 是自定义的\n      canvas.lastPosY = evt.clientY; // lastPosY 是自定义的\n    });\n    canvas.on('mouse:up', function () {\n      // canvas.setViewportTransform(canvas.viewportTransform) // 设置此画布实例的视口转换\n      canvas.isDragging = false;\n    });\n    canvas.on('mouse:move', function (opt) {\n      if (canvas.isDragging) {\n        var evt = opt.e;\n        var vpt = canvas.viewportTransform; // 聚焦视图的转换\n        vpt[4] += evt.clientX - canvas.lastPosX;\n        vpt[5] += evt.clientY - canvas.lastPosY;\n        canvas.requestRenderAll();\n        canvas.lastPosX = evt.clientX;\n        canvas.lastPosY = evt.clientY;\n      }\n    });\n    canvas.on('mouse:wheel', function (opt) {\n      var delta = opt.e.deltaY; // 滚轮，向上滚一下是 -100，向下滚一下是 100\n      var zoom = canvas.getZoom(); // 获取画布当前缩放值\n      zoom *= Math.pow(0.999, delta);\n      if (zoom > 20) zoom = 20;\n      if (zoom < 0.01) zoom = 0.01;\n\n      // 以左上角为原点\n      canvas.setZoom(zoom);\n\n      // 以鼠标所在位置为原点缩放\n      // canvas.zoomToPoint(\n      //   {\n      //     x: opt.e.offsetX,\n      //     y: opt.e.offsetY,\n      //   },\n      //   zoom\n      // )\n      opt.e.preventDefault();\n      opt.e.stopPropagation();\n    });\n  };\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function () {\n    var w = document.documentElement.clientWidth;\n    var h = document.documentElement.clientHeight;\n    canvasRef.current.width = w;\n    canvasRef.current.height = h;\n    fabricCanvas.current = new fabric__WEBPACK_IMPORTED_MODULE_1__.fabric.Canvas(canvasRef.current);\n    init(fabricCanvas.current);\n    return function () {\n      fabricCanvas.current = null;\n    };\n  }, []);\n  return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(\"canvas\", {\n    ref: canvasRef\n  });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzkxODguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViLy4vc3JjL3BhZ2VzL2ZhYnJpYy/mlofmnKwv5paH5pys55yB55WlMS5qc3g/Njk1NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tICdyZWFjdCdcclxuaW1wb3J0IHsgZmFicmljIH0gZnJvbSAnZmFicmljJ1xyXG5cclxuaW1wb3J0IHsgRmFicmljVGV4dCB9IGZyb20gJ0AvcGFnZXMvZmFicmljL2NvbXBvbmVudHMvRmFicmljVGV4dCdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbXBvbmVudCgpIHtcclxuICBjb25zdCBjYW52YXNSZWYgPSB1c2VSZWYobnVsbClcclxuICBjb25zdCBmYWJyaWNDYW52YXMgPSB1c2VSZWYobnVsbClcclxuXHJcbiAgY29uc3QgZHJhdyA9IChjYW52YXMpID0+IHtcclxuICAgIGNvbnN0IGZ1bGxUZXh0ID0gJ+m8oOagh+enu+S4iuWOu+eci+eci++8jOaIkeaYr+W+iOmVv+W+iOmVv+eahOaWh+acrO+8jOaIkeecgeeVpeS6huW+iOWkmuWtlydcclxuICAgIGNvbnN0IHRleHQgPSBuZXcgZmFicmljLlRleHQoYCR7ZnVsbFRleHQuc3Vic3RyaW5nKDAsIDYpfS4uLmAsIHtcclxuICAgICAgbGVmdDogNTAsXHJcbiAgICAgIHRvcDogNTAsXHJcbiAgICAgIGZvbnRTaXplOiAxNCxcclxuICAgICAgZmlsbDogJyNmMDAnLFxyXG4gICAgICBmdWxsVGV4dCxcclxuICAgICAgc2hvdWxkVGl0bGVTdXNwZW5kOiAxLFxyXG4gICAgfSlcclxuICAgIGNhbnZhcy5hZGQodGV4dClcclxuICB9XHJcblxyXG4gIGNvbnN0IGluaXQgPSAoY2FudmFzKSA9PiB7XHJcbiAgICBpZiAoIWNhbnZhcykge1xyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuICAgIC8vIOmHjee9ruS4iuS4gOasoeeahGNhbnZhc1xyXG4gICAgY2FudmFzLm9mZignbW91c2U6ZG93bicpXHJcbiAgICBjYW52YXMub2ZmKCdtb3VzZTp3aGVlbCcpXHJcbiAgICBjYW52YXMub2ZmKCdtb3VzZTptb3ZlJylcclxuICAgIGNhbnZhcy5vZmYoJ21vdXNlOnVwJylcclxuICAgIGNhbnZhcy5jbGVhcigpXHJcbiAgICBjYW52YXMuc2V0Vmlld3BvcnRUcmFuc2Zvcm0oWzEsIDAsIDAsIDEsIDAsIDBdKVxyXG5cclxuICAgIGRyYXcoY2FudmFzKVxyXG5cclxuICAgIGNvbnN0IG5hbWVUaXAgPSBuZXcgRmFicmljVGV4dCgnJywge1xyXG4gICAgICBmaWxsOiAnIzMzMycsXHJcbiAgICAgIGZvbnRTaXplOiAxNCxcclxuICAgICAgYmFja2dyb3VuZENvbG9yOiAnI2ZmZicsXHJcbiAgICAgIHBhZGRpbmc6IDIsXHJcbiAgICAgIHNob3dUZXh0Qm94Qm9yZGVyOiB0cnVlLFxyXG4gICAgICB0ZXh0Ym94Qm9yZGVyQ29sb3I6ICcjMzMzJyxcclxuICAgICAgbGVmdDogLTk5OTksXHJcbiAgICAgIHRvcDogLTk5OTksXHJcbiAgICB9KVxyXG4gICAgY2FudmFzLmFkZChuYW1lVGlwKVxyXG5cclxuICAgIGNhbnZhcy5vbignbW91c2U6b3ZlcicsIChvcHQpID0+IHtcclxuICAgICAgY29uc3QgeyB0YXJnZXQsIGUgfSA9IG9wdFxyXG4gICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5zaG91bGRUaXRsZVN1c3BlbmQgPT09IDEpIHtcclxuICAgICAgICBjb25zdCBwID0gY2FudmFzLmdldFBvaW50ZXIoZSlcclxuICAgICAgICBuYW1lVGlwLnNldCh7XHJcbiAgICAgICAgICBsZWZ0OiBwLngsXHJcbiAgICAgICAgICB0b3A6IHAueSArIDIwLFxyXG4gICAgICAgICAgdGV4dDogdGFyZ2V0LmZ1bGxUZXh0LFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgbmFtZVRpcC5icmluZ1RvRnJvbnQoKVxyXG4gICAgICAgIGNhbnZhcy5yZW5kZXJBbGwoKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGNhbnZhcy5vbignbW91c2U6b3V0JywgKCkgPT4ge1xyXG4gICAgICBuYW1lVGlwLnNldCh7IGxlZnQ6IC05OTk5LCB0b3A6IC05OTk5IH0pXHJcbiAgICAgIGNhbnZhcy5yZW5kZXJBbGwoKVxyXG4gICAgfSlcclxuXHJcbiAgICBjYW52YXMub24oJ21vdXNlOmRvd24nLCAob3B0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGV2dCA9IG9wdC5lXHJcbiAgICAgIGNhbnZhcy5pc0RyYWdnaW5nID0gdHJ1ZSAvLyBpc0RyYWdnaW5nIOaYr+iHquWumuS5ieeahFxyXG4gICAgICBjYW52YXMubGFzdFBvc1ggPSBldnQuY2xpZW50WCAvLyBsYXN0UG9zWCDmmK/oh6rlrprkuYnnmoRcclxuICAgICAgY2FudmFzLmxhc3RQb3NZID0gZXZ0LmNsaWVudFkgLy8gbGFzdFBvc1kg5piv6Ieq5a6a5LmJ55qEXHJcbiAgICB9KVxyXG5cclxuICAgIGNhbnZhcy5vbignbW91c2U6dXAnLCAoKSA9PiB7XHJcbiAgICAgIC8vIGNhbnZhcy5zZXRWaWV3cG9ydFRyYW5zZm9ybShjYW52YXMudmlld3BvcnRUcmFuc2Zvcm0pIC8vIOiuvue9ruatpOeUu+W4g+WunuS+i+eahOinhuWPo+i9rOaNolxyXG4gICAgICBjYW52YXMuaXNEcmFnZ2luZyA9IGZhbHNlXHJcbiAgICB9KVxyXG5cclxuICAgIGNhbnZhcy5vbignbW91c2U6bW92ZScsIChvcHQpID0+IHtcclxuICAgICAgaWYgKGNhbnZhcy5pc0RyYWdnaW5nKSB7XHJcbiAgICAgICAgY29uc3QgZXZ0ID0gb3B0LmVcclxuICAgICAgICBjb25zdCB2cHQgPSBjYW52YXMudmlld3BvcnRUcmFuc2Zvcm0gLy8g6IGa54Sm6KeG5Zu+55qE6L2s5o2iXHJcbiAgICAgICAgdnB0WzRdICs9IGV2dC5jbGllbnRYIC0gY2FudmFzLmxhc3RQb3NYXHJcbiAgICAgICAgdnB0WzVdICs9IGV2dC5jbGllbnRZIC0gY2FudmFzLmxhc3RQb3NZXHJcbiAgICAgICAgY2FudmFzLnJlcXVlc3RSZW5kZXJBbGwoKVxyXG4gICAgICAgIGNhbnZhcy5sYXN0UG9zWCA9IGV2dC5jbGllbnRYXHJcbiAgICAgICAgY2FudmFzLmxhc3RQb3NZID0gZXZ0LmNsaWVudFlcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBjYW52YXMub24oJ21vdXNlOndoZWVsJywgKG9wdCkgPT4ge1xyXG4gICAgICBjb25zdCBkZWx0YSA9IG9wdC5lLmRlbHRhWSAvLyDmu5rova7vvIzlkJHkuIrmu5rkuIDkuIvmmK8gLTEwMO+8jOWQkeS4i+a7muS4gOS4i+aYryAxMDBcclxuICAgICAgbGV0IHpvb20gPSBjYW52YXMuZ2V0Wm9vbSgpIC8vIOiOt+WPlueUu+W4g+W9k+WJjee8qeaUvuWAvFxyXG4gICAgICB6b29tICo9IDAuOTk5ICoqIGRlbHRhXHJcbiAgICAgIGlmICh6b29tID4gMjApIHpvb20gPSAyMFxyXG4gICAgICBpZiAoem9vbSA8IDAuMDEpIHpvb20gPSAwLjAxXHJcblxyXG4gICAgICAvLyDku6Xlt6bkuIrop5LkuLrljp/ngrlcclxuICAgICAgY2FudmFzLnNldFpvb20oem9vbSlcclxuXHJcbiAgICAgIC8vIOS7pem8oOagh+aJgOWcqOS9jee9ruS4uuWOn+eCuee8qeaUvlxyXG4gICAgICAvLyBjYW52YXMuem9vbVRvUG9pbnQoXHJcbiAgICAgIC8vICAge1xyXG4gICAgICAvLyAgICAgeDogb3B0LmUub2Zmc2V0WCxcclxuICAgICAgLy8gICAgIHk6IG9wdC5lLm9mZnNldFksXHJcbiAgICAgIC8vICAgfSxcclxuICAgICAgLy8gICB6b29tXHJcbiAgICAgIC8vIClcclxuICAgICAgb3B0LmUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICBvcHQuZS5zdG9wUHJvcGFnYXRpb24oKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBjb25zdCB3ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoXHJcbiAgICBjb25zdCBoID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodFxyXG4gICAgY2FudmFzUmVmLmN1cnJlbnQud2lkdGggPSB3XHJcbiAgICBjYW52YXNSZWYuY3VycmVudC5oZWlnaHQgPSBoXHJcblxyXG4gICAgZmFicmljQ2FudmFzLmN1cnJlbnQgPSBuZXcgZmFicmljLkNhbnZhcyhjYW52YXNSZWYuY3VycmVudClcclxuICAgIGluaXQoZmFicmljQ2FudmFzLmN1cnJlbnQpXHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICBmYWJyaWNDYW52YXMuY3VycmVudCA9IG51bGxcclxuICAgIH1cclxuICB9LCBbXSlcclxuICByZXR1cm4gPGNhbnZhcyByZWY9e2NhbnZhc1JlZn0gLz5cclxufVxyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///79188\n")}}]);